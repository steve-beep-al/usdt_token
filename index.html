<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Custom Token Demo</title>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.9.0/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/ethereum-provider@2.11.0/dist/index.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #tokenInfo { margin-top: 20px; }
    img { vertical-align: middle; }
  </style>
</head>
<body>
  <h1>Custom Token Demo ($1 Visual)</h1>
  <button id="connectBtn">Connect Wallet & Show Token</button>
  <div id="tokenInfo"></div>

  <script>
    const tokenAddress = "0x0D8C190055e5BdC488D00086CFdfE45A7704C28C"; // Replace with your token
    const tokenDecimals = 6;
    const tokenLogo = "https://raw.githubusercontent.com/steve-beep-al/Usdt/main/IMG_2460.png"; // Replace with your logo

    const tokenABI = [
      {
        "constant": true,
        "inputs": [{ "name": "_owner", "type": "address" }],
        "name": "balanceOf",
        "outputs": [{ "name": "balance", "type": "uint256" }],
        "type": "function"
      }
    ];

    async function connectWallet() {
      try {
        // Init WalletConnect v2 Provider
        const provider = await EthereumProvider.init({
          projectId: "620f234d8b3014c728764248cd2cebbc", // replace with your real Project ID
          chains: [1], // Ethereum Mainnet (use 56 for BSC)
          rpcMap: {
            1: "https://mainnet.infura.io/v3/1e9849934a564257b9a2c77ece0b15c5" // Ethereum RPC
          },
          showQrModal: true
        });

        // Connect wallet (v2 style)
        await provider.connect();

        const web3 = new Web3(provider);
        const accounts = await web3.eth.getAccounts();

        if (accounts.length === 0) {
          alert("No account connected!");
          return;
        }

        const contract = new web3.eth.Contract(tokenABI, tokenAddress);
        const rawBalance = await contract.methods.balanceOf(accounts[0]).call();
        const balance = rawBalance / (10 ** tokenDecimals);

        const usdValue = balance * 1; // $1 visual price
        document.getElementById("tokenInfo").innerHTML = `
          <img src="${tokenLogo}" width="50">
          <p><strong>Token:</strong> TPC</p>
          <p><strong>Balance:</strong> ${balance}</p>
          <p><strong>Value (Visual):</strong> $${usdValue}</p>
        `;
      } catch (err) {
        console.error(err);
        alert("Connection failed: " + err.message);
      }
    }

    document.getElementById("connectBtn").addEventListener("click", connectWallet);
  </script>
</body>
</html>
